#! /usr/bin/env bash

# ffmpeg -y -i STREAM_URL foo.mp3

if command -v sk > /dev/null; then
    search=sk
elif command -v fzf > /dev/null; then
    search=fzf
else
    echo "No search command found; please install one of 'skim' or 'fzf'"
    exit 1
fi

declare -A stations

stations=(
    ["BBC Radio 1"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/uk/sbr_high/ak/bbc_radio_one.m3u8'
    ["BBC Radio 2"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/uk/sbr_high/ak/bbc_radio_two.m3u8'
    ["BBC Radio 3"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/uk/sbr_high/ak/bbc_radio_three.m3u8'
    ["BBC Radio 4 FM"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/uk/sbr_high/ak/bbc_radio_fourfm.m3u8'
    ["BBC Radio 4 LW"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/uk/sbr_high/ak/bbc_radio_fourlw.m3u8'
    ["BBC World Service UK"]='http://bbcwssc.ic.llnwd.net/stream/bbcwssc_mp1_ws-eieuk'
    ["BBC World Service News"]='http://a.files.bbci.co.uk/media/live/manifesto/audio/simulcast/hls/nonuk/sbr_low/ak/bbc_world_service.m3u8'
)

station=$(for k in "${!stations[@]}"; do echo "$k"; done | $search)

cvlc "${stations[$station]}"
